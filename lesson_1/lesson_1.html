<!DOCTYPE HTML>
<html>
<head>
<script type='text/javascript'>
// We need this to support requestAnimationFrame on all browsers
(function() {
  "use strict";
  window.requestAnimationFrame =
    window.requestAnimationFrame ||
    window.mozRequestAnimationFrame ||
    window.webkitRequestAnimationFrame ||
    window.msRequestAnimationFrame;
})();

function bouncyBallInit(){
  "use strict";
  var BouncyBall = function(opts) {
    this.x = opts.x == null ? 100 : opts.x;
    this.y = opts.y == null ? 100 : opts.y;
    this.vx = opt.vx == null ? 1 : opts.vx;
    this.vy = opts.vy == null ? 1 : opts.vy;
    this.radius = opts.radiu || 20;
    this.color = opts.color || "#060";
  }
  var canvas = document.getElementById('myCanvas'),
    bouncyBall = new BouncyBall;
  // Drawing runs at the browser framerate.
  requestAnimationFrame(function f(time){
    requestAnimationFrame(f);
    tickSimulation(bouncyBall, canvas)
    drawBall(ball, canvas);
  });
}

function tickSimulation(ball, canvas){
  "use strict";
  var canvasWidth = canvas.width,
    canvasHeight = canvas.height;

  // Check whether we're about to hit the edge. If so, bounce by reversing the velocity
  if (ball.x - ball.radius + ball.vx) < 0) {
    ball.x = -1 * (ball.x - ball.radius + ball.vx);
    ball.vx *= -1;
  } else if (ball.x + ball.radius + ball.vx) > canvasWidth) {
    ball.x = canvasWidth - (ball.x + ball.radius + ball.vx - canvasWidth);
    ball.vx *= -1;
  } else if (ball.y - ball.radius + ball.vy) < 0) {
    ball.y = -1 * (ball.y - ball.radius + ball.vy);
    ball.vy *= -1;
  } else if (ball.y + ball.radius + ball.vy) > canvasHeight) {
    ball.y = canvasHeight - (ball.y + ball.radius + ball.vy - canvasHeight);
    ball.vy *= -1;
  } else {
    // Move by adding the vx and vy to the x and y
    ball.x += ball.vx;
    ball.y += ball.vy;
  }
}

function drawBall(ball, canvas){
  "use strict";
  var context = canvas.getContext('2d');
  context.clearRect(0, 0, 800, 400);
  context.beginPath();
  context.fillStyle = ball.color;
  // Draw a circle of radius 20 at the coordinates 100, 100 on the canvas
  context.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2, true);
  context.closePath();
  context.fill();
}

// Load script when document is done loading:
if(window.addEventListener) {
  addEventListener('load', bouncyBallInit);
} else if(window.attachEvent) {
  attachEvent('onload', bouncyBallInit);
}
</script>
<title>Bounce Ball step 1, Javascript and HTML tutorial</title>
<style>
body{background-color: #666;}
canvas {
  padding-left: 0;
  padding-right: 0;
  margin-left: auto;
  margin-right: auto;
  display: block;
  background-color: #ccc;
}
</style>
</head>
<body>
<canvas id="myCanvas" width="800" height="400"></canvas>
</body>
</html>
